Metadata-Version: 2.1
Name: py-xlsx-textconv
Version: 0.0.6
Summary: Git textconv tool for excel
Author-email: IIBUN Toshiyuki <toshiyuki.iibun@gmail.com>
Requires-Python: >=3.7
Classifier: Development Status :: 3 - Alpha
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Requires-Dist: oletools>=0.60.1
Requires-Dist: openpyxl==3.0.*
Project-URL: Repository, https://github.com/tiibun/py-xlsx-textconv
Description-Content-Type: text/markdown

# py_xlsx_textconv

Excel to text covert tool for Git.
This is a python port of [git-xlsx-textconv](https://github.com/tokuhirom/git-xlsx-textconv)

When git diff or git log -p, extract cell values in excel and format:

```
[SheetName1][TAB][A1][TAB][B1][TAB][C1][TAB]...
[SheetName1][TAB][A2][TAB][B2][TAB][C2][TAB]...
```

and compare text formats.

Example: Excel  
![excel](https://raw.githubusercontent.com/tiibun/py-xlsx-textconv/main/excel.png)

git diff  
![git diff](https://raw.githubusercontent.com/tiibun/py-xlsx-textconv/main/diff.png)


And experimental VBA support. (v0.0.4)

## This does not compare

- Style
- Auto Shapes
- ... and so on


## Install 

```
pip install py-xlsx-textconv
```

## Configuration

If `~/.config/git/attributes` (Windows: %HOMEPATH%\.config\git\attributes) does not exist, you need to creat and edit it.

```:~/.config/git/attributes
.xlsx diff=xlsx
.xlsm diff=xlsx
```

Or if you prefered per project attribute file, create `.gitattributes` file and edit it above

Append to `~/.gitconfig` (Windows: %HOMEPATH%\.gitconfig).

```:~/.gitconfig
[diff "xlsx"]
    binary = true
    textconv = py-xlsx-textconv
```

If you would like to compare values only, append `-d` option.

```:~/.gitconfig
[diff "xlsx"]
    binary = true
    textconv = py-xlsx-textconv -d
```


## Development

Install [pdm](https://pdm.fming.dev/latest/).

```
# install dependencies
pdm sync -d

# test
pdm run test
```

## LICENSE

MIT

